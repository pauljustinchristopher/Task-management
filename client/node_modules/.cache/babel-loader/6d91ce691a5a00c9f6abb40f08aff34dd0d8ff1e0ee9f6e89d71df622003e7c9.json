{"ast":null,"code":"import _objectSpread from\"C:/Users/paulj/Desktop/SIWES/defence project/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{Container,Typography,Button,Grid,Card,CardContent,CardActions,Chip,Box,Dialog,DialogTitle,DialogContent,TextField,DialogActions,MenuItem,LinearProgress,IconButton,Menu,MenuItem as MenuItemComponent}from'@mui/material';import{Add as AddIcon,MoreVert as MoreVertIcon,Edit as EditIcon,Delete as DeleteIcon,Visibility as ViewIcon}from'@mui/icons-material';import{useNavigate}from'react-router-dom';import{format}from'date-fns';import toast from'react-hot-toast';import{projectAPI}from'../services/apiServices';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Projects=()=>{const navigate=useNavigate();const[projects,setProjects]=useState([]);const[loading,setLoading]=useState(true);const[openDialog,setOpenDialog]=useState(false);const[editingProject,setEditingProject]=useState(null);const[anchorEl,setAnchorEl]=useState(null);const[selectedProject,setSelectedProject]=useState(null);const[formData,setFormData]=useState({name:'',description:'',status:'planning',priority:'medium',deadline:''});useEffect(()=>{fetchProjects();},[]);const fetchProjects=async()=>{try{const response=await projectAPI.getProjects();setProjects(response.data.projects||[]);}catch(error){toast.error('Failed to fetch projects');}finally{setLoading(false);}};const handleCreateProject=()=>{setEditingProject(null);setFormData({name:'',description:'',status:'planning',priority:'medium',deadline:''});setOpenDialog(true);};const handleEditProject=project=>{setEditingProject(project);setFormData({name:project.name,description:project.description,status:project.status,priority:project.priority,deadline:project.deadline?format(new Date(project.deadline),'yyyy-MM-dd'):''});setOpenDialog(true);setAnchorEl(null);};const handleSubmit=async()=>{try{const projectData=_objectSpread(_objectSpread({},formData),{},{deadline:formData.deadline?new Date(formData.deadline):null});if(editingProject){await projectAPI.updateProject(editingProject._id,projectData);toast.success('Project updated successfully');}else{await projectAPI.createProject(projectData);toast.success('Project created successfully');}setOpenDialog(false);fetchProjects();}catch(error){var _error$response,_error$response$data;toast.error(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||'An error occurred');}};const handleDeleteProject=async projectId=>{if(window.confirm('Are you sure you want to delete this project?')){try{await projectAPI.deleteProject(projectId);toast.success('Project deleted successfully');fetchProjects();}catch(error){toast.error('Failed to delete project');}}setAnchorEl(null);};const getStatusColor=status=>{switch(status){case'completed':return'success';case'in-progress':return'primary';case'planning':return'warning';case'on-hold':return'error';default:return'default';}};const getPriorityColor=priority=>{switch(priority){case'high':return'error';case'medium':return'warning';case'low':return'success';default:return'default';}};if(loading){return/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsx(LinearProgress,{})});}return/*#__PURE__*/_jsxs(Container,{maxWidth:\"lg\",sx:{mt:4,mb:4},children:[/*#__PURE__*/_jsxs(Box,{display:\"flex\",justifyContent:\"space-between\",alignItems:\"center\",mb:3,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",component:\"h1\",gutterBottom:true,children:\"Projects\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",startIcon:/*#__PURE__*/_jsx(AddIcon,{}),onClick:handleCreateProject,children:\"New Project\"})]}),/*#__PURE__*/_jsx(Grid,{container:true,spacing:3,children:projects.map(project=>/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:4,children:/*#__PURE__*/_jsxs(Card,{sx:{height:'100%',display:'flex',flexDirection:'column'},children:[/*#__PURE__*/_jsxs(CardContent,{sx:{flexGrow:1},children:[/*#__PURE__*/_jsxs(Box,{display:\"flex\",justifyContent:\"space-between\",alignItems:\"flex-start\",mb:2,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",component:\"h2\",gutterBottom:true,children:project.name}),/*#__PURE__*/_jsx(IconButton,{size:\"small\",onClick:e=>{setAnchorEl(e.currentTarget);setSelectedProject(project);},children:/*#__PURE__*/_jsx(MoreVertIcon,{})})]}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",paragraph:true,children:project.description}),/*#__PURE__*/_jsxs(Box,{mb:2,children:[/*#__PURE__*/_jsx(Chip,{label:project.status.replace('-',' ').toUpperCase(),color:getStatusColor(project.status),size:\"small\",sx:{mr:1}}),/*#__PURE__*/_jsx(Chip,{label:project.priority.toUpperCase(),color:getPriorityColor(project.priority),size:\"small\",variant:\"outlined\"})]}),project.deadline&&/*#__PURE__*/_jsxs(Typography,{variant:\"caption\",color:\"text.secondary\",children:[\"Due: \",format(new Date(project.deadline),'MMM dd, yyyy')]}),/*#__PURE__*/_jsxs(Box,{mt:2,children:[/*#__PURE__*/_jsxs(Typography,{variant:\"caption\",color:\"text.secondary\",children:[\"Tasks: \",project.totalTasks||0,\" | Completed: \",project.completedTasks||0]}),/*#__PURE__*/_jsx(LinearProgress,{variant:\"determinate\",value:project.totalTasks?project.completedTasks/project.totalTasks*100:0,sx:{mt:1}})]})]}),/*#__PURE__*/_jsx(CardActions,{children:/*#__PURE__*/_jsx(Button,{size:\"small\",startIcon:/*#__PURE__*/_jsx(ViewIcon,{}),onClick:()=>navigate(\"/projects/\".concat(project._id)),children:\"View\"})})]})},project._id))}),/*#__PURE__*/_jsxs(Menu,{anchorEl:anchorEl,open:Boolean(anchorEl),onClose:()=>setAnchorEl(null),children:[/*#__PURE__*/_jsxs(MenuItemComponent,{onClick:()=>handleEditProject(selectedProject),children:[/*#__PURE__*/_jsx(EditIcon,{sx:{mr:1},fontSize:\"small\"}),\"Edit\"]}),/*#__PURE__*/_jsxs(MenuItemComponent,{onClick:()=>handleDeleteProject(selectedProject===null||selectedProject===void 0?void 0:selectedProject._id),sx:{color:'error.main'},children:[/*#__PURE__*/_jsx(DeleteIcon,{sx:{mr:1},fontSize:\"small\"}),\"Delete\"]})]}),/*#__PURE__*/_jsxs(Dialog,{open:openDialog,onClose:()=>setOpenDialog(false),maxWidth:\"sm\",fullWidth:true,children:[/*#__PURE__*/_jsx(DialogTitle,{children:editingProject?'Edit Project':'Create New Project'}),/*#__PURE__*/_jsxs(DialogContent,{children:[/*#__PURE__*/_jsx(TextField,{autoFocus:true,margin:\"dense\",label:\"Project Name\",fullWidth:true,variant:\"outlined\",value:formData.name,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{name:e.target.value})),sx:{mb:2}}),/*#__PURE__*/_jsx(TextField,{margin:\"dense\",label:\"Description\",fullWidth:true,multiline:true,rows:3,variant:\"outlined\",value:formData.description,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{description:e.target.value})),sx:{mb:2}}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:6,children:/*#__PURE__*/_jsxs(TextField,{select:true,label:\"Status\",fullWidth:true,value:formData.status,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{status:e.target.value})),children:[/*#__PURE__*/_jsx(MenuItem,{value:\"planning\",children:\"Planning\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"in-progress\",children:\"In Progress\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"on-hold\",children:\"On Hold\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"completed\",children:\"Completed\"})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:6,children:/*#__PURE__*/_jsxs(TextField,{select:true,label:\"Priority\",fullWidth:true,value:formData.priority,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{priority:e.target.value})),children:[/*#__PURE__*/_jsx(MenuItem,{value:\"low\",children:\"Low\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"medium\",children:\"Medium\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"high\",children:\"High\"})]})})]}),/*#__PURE__*/_jsx(TextField,{margin:\"normal\",label:\"Deadline\",type:\"date\",fullWidth:true,InputLabelProps:{shrink:true},value:formData.deadline,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{deadline:e.target.value}))})]}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:()=>setOpenDialog(false),children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{onClick:handleSubmit,variant:\"contained\",children:editingProject?'Update':'Create'})]})]})]});};export default Projects;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}