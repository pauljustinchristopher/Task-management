{"ast":null,"code":"import _objectSpread from\"C:/Users/paulj/Desktop/SIWES/defence project/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState}from'react';import{Container,Paper,Typography,Avatar,Button,TextField,Grid,Box,Divider,Card,CardContent,IconButton,Dialog,DialogTitle,DialogContent,DialogActions}from'@mui/material';import{Edit as EditIcon,PhotoCamera as PhotoCameraIcon,Save as SaveIcon,Cancel as CancelIcon}from'@mui/icons-material';import{useAuth}from'../contexts/AuthContext';import toast from'react-hot-toast';import{authAPI}from'../services/apiServices';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Profile=()=>{var _user$name;const{user,updateUser}=useAuth();const[editing,setEditing]=useState(false);const[openPasswordDialog,setOpenPasswordDialog]=useState(false);const[formData,setFormData]=useState({name:(user===null||user===void 0?void 0:user.name)||'',email:(user===null||user===void 0?void 0:user.email)||'',bio:(user===null||user===void 0?void 0:user.bio)||'',location:(user===null||user===void 0?void 0:user.location)||'',website:(user===null||user===void 0?void 0:user.website)||''});const[passwordData,setPasswordData]=useState({currentPassword:'',newPassword:'',confirmPassword:''});const handleSave=async()=>{try{const response=await authAPI.updateProfile(formData);updateUser(response.data.data);setEditing(false);toast.success('Profile updated successfully');}catch(error){var _error$response,_error$response$data;toast.error(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||'Failed to update profile');}};const handleCancel=()=>{setFormData({name:(user===null||user===void 0?void 0:user.name)||'',email:(user===null||user===void 0?void 0:user.email)||'',bio:(user===null||user===void 0?void 0:user.bio)||'',location:(user===null||user===void 0?void 0:user.location)||'',website:(user===null||user===void 0?void 0:user.website)||''});setEditing(false);};const handlePasswordChange=async()=>{if(passwordData.newPassword!==passwordData.confirmPassword){toast.error('New passwords do not match');return;}try{await authAPI.updatePassword({currentPassword:passwordData.currentPassword,newPassword:passwordData.newPassword});setOpenPasswordDialog(false);setPasswordData({currentPassword:'',newPassword:'',confirmPassword:''});toast.success('Password updated successfully');}catch(error){var _error$response2,_error$response2$data;toast.error(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||'Failed to update password');}};return/*#__PURE__*/_jsxs(Container,{maxWidth:\"md\",sx:{mt:4,mb:4},children:[/*#__PURE__*/_jsxs(Paper,{elevation:3,sx:{p:4},children:[/*#__PURE__*/_jsxs(Box,{display:\"flex\",justifyContent:\"space-between\",alignItems:\"center\",mb:4,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",component:\"h1\",children:\"Profile\"}),!editing?/*#__PURE__*/_jsx(Button,{variant:\"outlined\",startIcon:/*#__PURE__*/_jsx(EditIcon,{}),onClick:()=>setEditing(true),children:\"Edit Profile\"}):/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Button,{variant:\"contained\",startIcon:/*#__PURE__*/_jsx(SaveIcon,{}),onClick:handleSave,sx:{mr:1},children:\"Save\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",startIcon:/*#__PURE__*/_jsx(CancelIcon,{}),onClick:handleCancel,children:\"Cancel\"})]})]}),/*#__PURE__*/_jsxs(Box,{display:\"flex\",flexDirection:\"column\",alignItems:\"center\",mb:4,children:[/*#__PURE__*/_jsxs(Box,{position:\"relative\",children:[/*#__PURE__*/_jsx(Avatar,{sx:{width:120,height:120,mb:2},src:user===null||user===void 0?void 0:user.avatar,children:user===null||user===void 0?void 0:(_user$name=user.name)===null||_user$name===void 0?void 0:_user$name.charAt(0).toUpperCase()}),editing&&/*#__PURE__*/_jsx(IconButton,{sx:{position:'absolute',bottom:16,right:-8,bgcolor:'primary.main',color:'white','&:hover':{bgcolor:'primary.dark'}},size:\"small\",children:/*#__PURE__*/_jsx(PhotoCameraIcon,{})})]}),/*#__PURE__*/_jsx(Typography,{variant:\"h5\",gutterBottom:true,children:user===null||user===void 0?void 0:user.name}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:user===null||user===void 0?void 0:user.email})]}),/*#__PURE__*/_jsx(Divider,{sx:{mb:4}}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:3,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{label:\"Full Name\",fullWidth:true,value:formData.name,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{name:e.target.value})),disabled:!editing,variant:\"outlined\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{label:\"Email\",type:\"email\",fullWidth:true,value:formData.email,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{email:e.target.value})),disabled:!editing,variant:\"outlined\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{label:\"Bio\",fullWidth:true,multiline:true,rows:3,value:formData.bio,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{bio:e.target.value})),disabled:!editing,variant:\"outlined\",placeholder:\"Tell us about yourself...\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{label:\"Location\",fullWidth:true,value:formData.location,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{location:e.target.value})),disabled:!editing,variant:\"outlined\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{label:\"Website\",fullWidth:true,value:formData.website,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{website:e.target.value})),disabled:!editing,variant:\"outlined\",placeholder:\"https://yourwebsite.com\"})})]}),/*#__PURE__*/_jsx(Divider,{sx:{my:4}}),/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Account Settings\"}),/*#__PURE__*/_jsxs(Box,{display:\"flex\",justifyContent:\"space-between\",alignItems:\"center\",children:[/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"body1\",children:\"Password\"}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"text.secondary\",children:[\"Last updated: \",user!==null&&user!==void 0&&user.updatedAt?new Date(user.updatedAt).toLocaleDateString():'Never']})]}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",onClick:()=>setOpenPasswordDialog(true),children:\"Change Password\"})]})]})}),/*#__PURE__*/_jsxs(Box,{mt:4,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Account Statistics\"}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:4,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{sx:{textAlign:'center'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",color:\"primary\",children:(user===null||user===void 0?void 0:user.projectsCount)||0}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:\"Projects Created\"})]})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:4,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{sx:{textAlign:'center'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",color:\"primary\",children:(user===null||user===void 0?void 0:user.tasksCount)||0}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:\"Tasks Completed\"})]})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:4,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{sx:{textAlign:'center'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",color:\"primary\",children:user!==null&&user!==void 0&&user.createdAt?Math.floor((new Date()-new Date(user.createdAt))/(1000*60*60*24)):0}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:\"Days Active\"})]})})})]})]})]}),/*#__PURE__*/_jsxs(Dialog,{open:openPasswordDialog,onClose:()=>setOpenPasswordDialog(false),maxWidth:\"sm\",fullWidth:true,children:[/*#__PURE__*/_jsx(DialogTitle,{children:\"Change Password\"}),/*#__PURE__*/_jsxs(DialogContent,{children:[/*#__PURE__*/_jsx(TextField,{margin:\"dense\",label:\"Current Password\",type:\"password\",fullWidth:true,variant:\"outlined\",value:passwordData.currentPassword,onChange:e=>setPasswordData(_objectSpread(_objectSpread({},passwordData),{},{currentPassword:e.target.value})),sx:{mb:2}}),/*#__PURE__*/_jsx(TextField,{margin:\"dense\",label:\"New Password\",type:\"password\",fullWidth:true,variant:\"outlined\",value:passwordData.newPassword,onChange:e=>setPasswordData(_objectSpread(_objectSpread({},passwordData),{},{newPassword:e.target.value})),sx:{mb:2}}),/*#__PURE__*/_jsx(TextField,{margin:\"dense\",label:\"Confirm New Password\",type:\"password\",fullWidth:true,variant:\"outlined\",value:passwordData.confirmPassword,onChange:e=>setPasswordData(_objectSpread(_objectSpread({},passwordData),{},{confirmPassword:e.target.value}))})]}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:()=>setOpenPasswordDialog(false),children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{onClick:handlePasswordChange,variant:\"contained\",children:\"Update Password\"})]})]})]});};export default Profile;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}