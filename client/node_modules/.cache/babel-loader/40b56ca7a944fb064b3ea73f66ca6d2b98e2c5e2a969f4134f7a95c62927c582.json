{"ast":null,"code":"import _objectSpread from\"C:/Users/paulj/Desktop/SIWES/defence project/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useParams,useNavigate}from'react-router-dom';import{Container,Typography,Box,Card,CardContent,Grid,Chip,Button,Tab,Tabs,List,ListItem,ListItemText,ListItemAvatar,Avatar,IconButton,LinearProgress,Divider,Dialog,DialogTitle,DialogContent,TextField,DialogActions}from'@mui/material';import{ArrowBack as ArrowBackIcon,Edit as EditIcon,Add as AddIcon,Assignment as TaskIcon,People as PeopleIcon,Timeline as TimelineIcon}from'@mui/icons-material';import{format}from'date-fns';import toast from'react-hot-toast';import{projectAPI,taskAPI}from'../services/apiServices';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProjectDetail=()=>{const{id}=useParams();const navigate=useNavigate();const[project,setProject]=useState(null);const[tasks,setTasks]=useState([]);const[members,setMembers]=useState([]);const[activities,setActivities]=useState([]);const[loading,setLoading]=useState(true);const[tabValue,setTabValue]=useState(0);const[openTaskDialog,setOpenTaskDialog]=useState(false);const[taskFormData,setTaskFormData]=useState({title:'',description:'',priority:'medium',dueDate:''});useEffect(()=>{if(id){fetchProjectDetails();}},[id]);const fetchProjectDetails=async()=>{try{var _projectRes$data;const[projectRes,tasksRes]=await Promise.all([projectAPI.getProject(id),taskAPI.getTasks({project:id})]);setProject(projectRes.data);setTasks(tasksRes.data||[]);// You can add members and activities fetch here\nsetMembers(((_projectRes$data=projectRes.data)===null||_projectRes$data===void 0?void 0:_projectRes$data.members)||[]);setActivities([]);}catch(error){toast.error('Failed to fetch project details');navigate('/projects');}finally{setLoading(false);}};const handleCreateTask=async()=>{try{const taskData=_objectSpread(_objectSpread({},taskFormData),{},{project:id,dueDate:taskFormData.dueDate?new Date(taskFormData.dueDate):null});await taskAPI.createTask(taskData);toast.success('Task created successfully');setOpenTaskDialog(false);setTaskFormData({title:'',description:'',priority:'medium',dueDate:''});fetchProjectDetails();}catch(error){toast.error('Failed to create task');}};const getStatusColor=status=>{switch(status){case'completed':return'success';case'in-progress':return'primary';case'planning':return'warning';case'on-hold':return'error';default:return'default';}};const getPriorityColor=priority=>{switch(priority){case'high':return'error';case'medium':return'warning';case'low':return'success';default:return'default';}};const getTaskStatusColor=status=>{switch(status){case'completed':return'success';case'in-progress':return'primary';case'todo':return'warning';case'review':return'info';default:return'default';}};if(loading){return/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsx(LinearProgress,{})});}if(!project){return/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsx(Typography,{variant:\"h4\",children:\"Project not found\"})});}const completedTasks=tasks.filter(task=>task.status==='completed').length;const progressPercentage=tasks.length>0?completedTasks/tasks.length*100:0;return/*#__PURE__*/_jsxs(Container,{maxWidth:\"lg\",sx:{mt:4,mb:4},children:[/*#__PURE__*/_jsxs(Box,{display:\"flex\",alignItems:\"center\",mb:3,children:[/*#__PURE__*/_jsx(IconButton,{onClick:()=>navigate('/projects'),sx:{mr:2},children:/*#__PURE__*/_jsx(ArrowBackIcon,{})}),/*#__PURE__*/_jsx(Typography,{variant:\"h4\",component:\"h1\",sx:{flexGrow:1},children:project.name}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",startIcon:/*#__PURE__*/_jsx(EditIcon,{}),onClick:()=>navigate(\"/projects/\".concat(id,\"/edit\")),sx:{mr:2},children:\"Edit Project\"})]}),/*#__PURE__*/_jsx(Card,{sx:{mb:3},children:/*#__PURE__*/_jsx(CardContent,{children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:3,children:[/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,md:8,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Description\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",paragraph:true,children:project.description}),/*#__PURE__*/_jsxs(Box,{display:\"flex\",gap:1,mb:2,children:[/*#__PURE__*/_jsx(Chip,{label:project.status.replace('-',' ').toUpperCase(),color:getStatusColor(project.status),size:\"small\"}),/*#__PURE__*/_jsx(Chip,{label:project.priority.toUpperCase(),color:getPriorityColor(project.priority),size:\"small\",variant:\"outlined\"})]}),project.deadline&&/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"text.secondary\",children:[\"Due: \",format(new Date(project.deadline),'PPP')]})]}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,md:4,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Progress\"}),/*#__PURE__*/_jsxs(Box,{mb:2,children:[/*#__PURE__*/_jsxs(Box,{display:\"flex\",justifyContent:\"space-between\",mb:1,children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:\"Tasks Completed\"}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[completedTasks,\"/\",tasks.length]})]}),/*#__PURE__*/_jsx(LinearProgress,{variant:\"determinate\",value:progressPercentage}),/*#__PURE__*/_jsxs(Typography,{variant:\"caption\",color:\"text.secondary\",children:[Math.round(progressPercentage),\"% Complete\"]})]})]})]})})}),/*#__PURE__*/_jsx(Box,{sx:{borderBottom:1,borderColor:'divider',mb:3},children:/*#__PURE__*/_jsxs(Tabs,{value:tabValue,onChange:(e,newValue)=>setTabValue(newValue),children:[/*#__PURE__*/_jsx(Tab,{icon:/*#__PURE__*/_jsx(TaskIcon,{}),label:\"Tasks (\".concat(tasks.length,\")\"),iconPosition:\"start\"}),/*#__PURE__*/_jsx(Tab,{icon:/*#__PURE__*/_jsx(PeopleIcon,{}),label:\"Members (\".concat(members.length,\")\"),iconPosition:\"start\"}),/*#__PURE__*/_jsx(Tab,{icon:/*#__PURE__*/_jsx(TimelineIcon,{}),label:\"Activity\",iconPosition:\"start\"})]})}),tabValue===0&&/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsxs(Box,{display:\"flex\",justifyContent:\"space-between\",alignItems:\"center\",mb:2,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:\"Tasks\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",startIcon:/*#__PURE__*/_jsx(AddIcon,{}),onClick:()=>setOpenTaskDialog(true),children:\"Add Task\"})]}),/*#__PURE__*/_jsx(Grid,{container:true,spacing:2,children:tasks.map(task=>/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:4,children:/*#__PURE__*/_jsx(Card,{sx:{cursor:'pointer','&:hover':{boxShadow:4}},onClick:()=>navigate(\"/tasks/\".concat(task._id)),children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:task.title}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",paragraph:true,children:task.description}),/*#__PURE__*/_jsxs(Box,{display:\"flex\",gap:1,mb:1,children:[/*#__PURE__*/_jsx(Chip,{label:task.status.replace('-',' ').toUpperCase(),color:getTaskStatusColor(task.status),size:\"small\"}),/*#__PURE__*/_jsx(Chip,{label:task.priority.toUpperCase(),color:getPriorityColor(task.priority),size:\"small\",variant:\"outlined\"})]}),task.dueDate&&/*#__PURE__*/_jsxs(Typography,{variant:\"caption\",color:\"text.secondary\",children:[\"Due: \",format(new Date(task.dueDate),'MMM dd, yyyy')]})]})})},task._id))})]}),tabValue===1&&/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Project Members\"}),/*#__PURE__*/_jsx(List,{children:members.map((member,index)=>{var _member$user,_member$user$name,_member$user2,_member$user3;return/*#__PURE__*/_jsxs(ListItem,{children:[/*#__PURE__*/_jsx(ListItemAvatar,{children:/*#__PURE__*/_jsx(Avatar,{children:(_member$user=member.user)===null||_member$user===void 0?void 0:(_member$user$name=_member$user.name)===null||_member$user$name===void 0?void 0:_member$user$name.charAt(0).toUpperCase()})}),/*#__PURE__*/_jsx(ListItemText,{primary:(_member$user2=member.user)===null||_member$user2===void 0?void 0:_member$user2.name,secondary:\"\".concat(member.role,\" \\u2022 \").concat((_member$user3=member.user)===null||_member$user3===void 0?void 0:_member$user3.email)}),/*#__PURE__*/_jsx(Chip,{label:member.role.toUpperCase(),size:\"small\",variant:\"outlined\"})]},index);})})]}),tabValue===2&&/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Recent Activity\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:\"Activity timeline will be displayed here\"})]}),/*#__PURE__*/_jsxs(Dialog,{open:openTaskDialog,onClose:()=>setOpenTaskDialog(false),maxWidth:\"sm\",fullWidth:true,children:[/*#__PURE__*/_jsx(DialogTitle,{children:\"Create New Task\"}),/*#__PURE__*/_jsxs(DialogContent,{children:[/*#__PURE__*/_jsx(TextField,{autoFocus:true,margin:\"dense\",label:\"Task Title\",fullWidth:true,variant:\"outlined\",value:taskFormData.title,onChange:e=>setTaskFormData(_objectSpread(_objectSpread({},taskFormData),{},{title:e.target.value})),sx:{mb:2}}),/*#__PURE__*/_jsx(TextField,{margin:\"dense\",label:\"Description\",fullWidth:true,multiline:true,rows:3,variant:\"outlined\",value:taskFormData.description,onChange:e=>setTaskFormData(_objectSpread(_objectSpread({},taskFormData),{},{description:e.target.value})),sx:{mb:2}}),/*#__PURE__*/_jsxs(TextField,{select:true,label:\"Priority\",fullWidth:true,value:taskFormData.priority,onChange:e=>setTaskFormData(_objectSpread(_objectSpread({},taskFormData),{},{priority:e.target.value})),SelectProps:{native:true},sx:{mb:2},children:[/*#__PURE__*/_jsx(\"option\",{value:\"low\",children:\"Low\"}),/*#__PURE__*/_jsx(\"option\",{value:\"medium\",children:\"Medium\"}),/*#__PURE__*/_jsx(\"option\",{value:\"high\",children:\"High\"})]}),/*#__PURE__*/_jsx(TextField,{margin:\"normal\",label:\"Due Date\",type:\"date\",fullWidth:true,InputLabelProps:{shrink:true},value:taskFormData.dueDate,onChange:e=>setTaskFormData(_objectSpread(_objectSpread({},taskFormData),{},{dueDate:e.target.value}))})]}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:()=>setOpenTaskDialog(false),children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{onClick:handleCreateTask,variant:\"contained\",children:\"Create Task\"})]})]})]});};export default ProjectDetail;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}